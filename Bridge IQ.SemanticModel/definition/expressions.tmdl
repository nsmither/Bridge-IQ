expression stop_historic =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_stop = Source{[Schema="dbo",Item="stop"]}[Data],
		    #"Filtered Stops Pre RefreshCutOffDate" = Table.SelectRows(dbo_stop, each [sched_arrive_early] < RefreshCutOffDate),
		    #"Removed Columns" = Table.RemoveColumns(#"Filtered Stops Pre RefreshCutOffDate",{"company_id", "address2", "appointment_status_id", "appt_contact_name", "hub", "cases", "confirmed", "contact_name", "dist_from_prev", "dist_from_prev_um", "driver_load_unload", "edi_code", "edi_loc_code", "eta", "eta_distance", "eta_late", "eta_oor", "google_place_id", "inbound_status", "late_eta_colorcode", "late_route_status", "manifest_fgp_uid", "manifest_reg_uid", "move_dist_from_preassign", "move_dist_from_preassign_um", "move_dist_from_previous", "move_dist_from_previous_um", "operational_status", "orig_sched_early", "orig_sched_late", "pallets_dropped", "pallets_picked_up", "phone", "planned_arrival_time", "ponum", "prior_uncleared_stops", "projected_arrival", "rate_dist_from_previous", "rate_dist_from_previous_um", "refno", "requested_service", "seal", "service_date", "showas_address", "showas_address2", "showas_city_id", "showas_city_name", "showas_location_id", "showas_location_name", "showas_state", "showas_zip_code", "signed_for_name", "txl_uid", "volume", "volume_um", "weight", "weight_um", "ic_stop_id", "grouped_id", "payment_code_reviewed", "trimble_place_id"}),
		    #"Inserted actual_arrival_time" = Table.AddColumn(#"Removed Columns", "actual_arrival_time", each DateTime.Time([actual_arrival]), type time),
		    #"Inserted actual_departure_time" = Table.AddColumn(#"Inserted actual_arrival_time", "actual_departure_time", each DateTime.Time([actual_departure]), type time),
		    #"Inserted sched_arrive_early_time" = Table.AddColumn(#"Inserted actual_departure_time", "sched_arrive_early_time", each DateTime.Time([sched_arrive_early]), type time),
		    #"Inserted sched_arrive_late_time" = Table.AddColumn(#"Inserted sched_arrive_early_time", "sched_arrive_late_time", each DateTime.Time([sched_arrive_late]), type time),
		    #"Changed Type" = Table.TransformColumnTypes(#"Inserted sched_arrive_late_time",{{"actual_arrival", type date}, {"actual_departure", type date}, {"sched_arrive_early", type date}, {"sched_arrive_late", type date}})
		in
		    #"Changed Type"
	lineageTag: b3dd5e3a-6047-4487-aedf-02870170447d
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression mcleod_historic_orders =
		let
		    Source = Sql.Databases("bl-appdb"),
		    lme = Source{[Name="lme"]}[Data],
		    dbo_orders = lme{[Schema="dbo",Item="orders"]}[Data],
		    #"Filtered Orders Pre RefreshCutOFfDate" = Table.SelectRows(dbo_orders, each [ordered_date] < RefreshCutOffDate),
		    //Start General Data Transformation
		    #"Removed Columns" = Table.RemoveColumns(#"Filtered Orders Pre RefreshCutOFfDate",{"company_id", "actual_reefer_profile", "agency_id", "agent_payee_id", "allow_relay", "autorate_status", "booking_no", "booking_number", "brk_qual_profile", "broker_location_id", "brokerage_workflow_id", "cbp_crossing_date", "cbp_crossing_location_id", "cbp_crossing_reason", "cbsa_crossing_date", "cbsa_crossing_location_id", "cbsa_crossing_reason", "cc_fuel_revenue", "cc_fuel_revenue_c", "cc_fuel_revenue_d", "cc_fuel_revenue_n", "cc_fuel_revenue_r", "cc_net_revenue", "cc_net_revenue_c", "cc_net_revenue_d", "cc_net_revenue_n", "cc_net_revenue_r", "cc_pro_nbr", "cobroker_location_id", "collection_method", "com_setpnt_temp", "com_setpnt_temp_um", "commitment_id", "container", "container_planned", "container_type_id", "controlling_carrier_code", "copy_from_company", "copy_from_order_id", "copy_to_company", "copy_to_order_id", "ctrl_party_id", "cube", "curr_movement_id", "cust_order_no", "declared_val", "def_move_type", "default_match_id", "dim_height", "dim_length", "dim_surcharge", "dim_surcharge_c", "dim_surcharge_d", "dim_surcharge_n", "dim_surcharge_r", "dim_width", "dispatch_opt", "dl_team_reqd", "dray_del_date", "dray_del_pay", "dray_del_pay_c", "dray_del_pay_d", "dray_del_pay_n", "dray_del_pay_r", "dray_del_payee", "dray_del_xfer_dt", "dray_pu_date", "dray_pu_pay", "dray_pu_pay_c", "dray_pu_pay_d", "dray_pu_pay_n", "dray_pu_pay_r", "dray_pu_payee", "dray_pu_xfer_dt", "eir1_no", "eir2_no", "est_tolls", "est_tolls_c", "est_tolls_d", "est_tolls_n", "est_tolls_r", "excise_disable_update", "excise_taxable", "excisetax_total", "excisetax_total_c", "excisetax_total_d", "excisetax_total_n", "excisetax_total_r", "force_assign", "forwd_location_id", "free_days", "freight_charge_c", "freight_charge_d", "freight_charge_r", "high_value", "hold_reason", "image_is_present", "import_export", "include_split_point", "intelliset", "invoice_recv_date", "is_autorate_dist", "is_container", "is_dedicated", "is_local_mile", "is_requested", "jag_carrier_id", "jag_cost_rate_id", "ldport_location_id", "linear_feet_avail", "loadboard", "ltl", "markup_flat", "markup_flat_c", "markup_flat_d", "markup_flat_n", "markup_flat_r", "markup_percent", "master_order_id", "master_sequence", "next_rebill", "nte_lp_num", "nte_lp_qual", "operational_status", "optiset", "optimize", "order_mode", "order_value_c", "order_value_d", "order_value_n", "order_value_r", "orig_dest_rate_id", "otherchargetotal_c", "otherchargetotal_d", "otherchargetotal_n", "otherchargetotal_r", "pallets_required", "pay_gross_d", "pay_gross_n", "pay_gross_r", "planning_comment", "pnn_callback", "pnn_comment", "pnn_comment2", "pnn_post_type", "pnn_rate", "pay_gross", "pay_gross_c", "pick_up_no", "pnn_rate_type", "pnn_trailer_length", "pnn_trailer_width", "ponum", "port", "port_of_discharge", "preload_trailer_id", "preloaded", "rate_currency_type", "rate_id", "rate_min_weight", "rate_min_weight_um", "rate_unit_desc", "recurring_order_id", "reply_transmitted", "requesting_company", "return_temp", "return_temp_um", "return_temp_var", "return_temp_var_um", "revenue_share_method", "sail_date", "seal_number", "seg_alloc_code", "setpoint_temp", "setpoint_temp_um", "setpoint_var", "setpoint_var_um", "ship_status_to_edi", "shipment_id", "shipstatus2edi_dt", "ss_location_id", "subject_order_status", "subject_order_void_date", "swap", "teams_required", "temperature_max_um", "temperature_min_um", "total_charge_c", "total_charge_d", "total_charge_n", "total_charge_r", "totalcharge_and_excisetax_c", "totalcharge_and_excisetax_d", "totalcharge_and_excisetax_n", "totalcharge_and_excisetax_r", "tractor_type", "vessel", "vessel_cutoff_date", "bill_distance_um", "billing_empty_distance", "billing_empty_distance_um", "billing_loaded_distance", "billing_loaded_distance_um", "bol_note", "external_invoiceno", "freight_charge_n", "load_date", "ordered_by", "ordered_method", "placard_required", "rate", "rate_type", "rate_units", "ready_to_bill", "totalcharge_and_excisetax", "weight_um", "xferred2billing", "xferred2billing_dt", "lock_miles", "is_auto_tonu", "floor_loaded_freight", "equipment_type_options", "ic_movement_from", "ic_company_from", "is_intercompany", "rate_source", "ic_order_from", "ordered_by_id", "pnn_loadboard_user_id", "voided_load_transmitted_dt", "voided_load_transmitted", "total_charge"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"blnum", "customer_po"}, {"consignee_refno", "bol"}, {"ordered_date", "order_entered_date"}, {"otherchargetotal", "other_charges_total"}, {"salesperson", "salesperson_id"}}),
		    #"Inserted order_entered_time" = Table.AddColumn(#"Renamed Columns", "order_entered_time", each DateTime.Time([order_entered_date]), type time),
		    //End General Data Transformation
		    #"Changed Type" = Table.TransformColumnTypes(#"Inserted order_entered_time",{{"bill_date", type date}, {"freight_charge", Currency.Type}, {"order_entered_date", type date}, {"other_charges_total", Currency.Type}}),
		    #"Filtered Rows" = Table.SelectRows(#"Changed Type", each ([status] = "D" or [status] = "P")),
		    //Start add shipper and consignee data
		    #"Merged stop table shipper" = Table.NestedJoin(#"Filtered Rows", {"shipper_stop_id"}, stop, {"id"}, "stop", JoinKind.LeftOuter),
		    #"Expanded stop" = Table.ExpandTableColumn(#"Merged stop table shipper", "stop", {"city_name", "location_name", "sched_arrive_early", "sched_arrive_late", "state", "zip_code", "sched_arrive_early_time", "sched_arrive_late_time"}, {"stop.city_name", "stop.location_name", "stop.sched_arrive_early", "stop.sched_arrive_late", "stop.state", "stop.zip_code", "stop.sched_arrive_early_time", "stop.sched_arrive_late_time"}),
		    #"Renamed shipper data" = Table.RenameColumns(#"Expanded stop",{{"stop.city_name", "shipper_city_name"}, {"stop.location_name", "shipper_location_name"}, {"stop.sched_arrive_early", "shipper_sched_early_date"}, {"stop.sched_arrive_late", "shipper_sched_late_date"}, {"stop.state", "shipper_state"}, {"stop.zip_code", "shipper_zip_code"}, {"stop.sched_arrive_early_time", "shipper_sched_early_time"}, {"stop.sched_arrive_late_time", "shipper_sched_late_time"}}),
		    #"Merged stop table consignee" = Table.NestedJoin(#"Renamed shipper data", {"consignee_stop_id"}, stop, {"id"}, "stop", JoinKind.LeftOuter),
		    #"Expanded stop1" = Table.ExpandTableColumn(#"Merged stop table consignee", "stop", {"city_id", "city_name", "location_name", "sched_arrive_early", "sched_arrive_late", "state", "zip_code", "sched_arrive_early_time", "sched_arrive_late_time"}, {"stop.city_id", "stop.city_name", "stop.location_name", "stop.sched_arrive_early", "stop.sched_arrive_late", "stop.state", "stop.zip_code", "stop.sched_arrive_early_time", "stop.sched_arrive_late_time"}),
		    //End add shipper and consignee data
		    #"Renamed consignee data" = Table.RenameColumns(#"Expanded stop1",{{"stop.city_id", "consignee_city_id"}, {"stop.city_name", "consignee_city_name"}, {"stop.location_name", "consignee_location_name"}, {"stop.sched_arrive_early", "consignee_sched_early_date"}, {"stop.sched_arrive_late", "consignee_sched_late_date"}, {"stop.state", "consignee_state"}, {"stop.zip_code", "consignee_zip_code"}, {"stop.sched_arrive_early_time", "consignee_sched_early_time"}, {"stop.sched_arrive_late_time", "consignee_sched_late_time"}}),
		    #"Inserted First Characters" = Table.AddColumn(#"Renamed consignee data", "shipper_3_digit_zip_code", each Text.Start([shipper_zip_code], 3), type text),
		    #"Inserted First Characters1" = Table.AddColumn(#"Inserted First Characters", "consignee_3_digit_zip_code", each Text.Start([consignee_zip_code], 3), type text),
		    //Start Add Lane
		    #"Trimmed Text" = Table.TransformColumns(#"Inserted First Characters1",{{"shipper_city_name", Text.Trim, type text}, {"shipper_state", Text.Trim, type text}, {"consignee_city_name", Text.Trim, type text}, {"consignee_state", Text.Trim, type text}}),
		    #"Duplicated Column" = Table.DuplicateColumn(#"Trimmed Text", "shipper_city_name", "shipper_city_name - Copy"),
		    #"Duplicated Column1" = Table.DuplicateColumn(#"Duplicated Column", "shipper_state", "shipper_state - Copy"),
		    #"Duplicated Column2" = Table.DuplicateColumn(#"Duplicated Column1", "consignee_city_name", "consignee_city_name - Copy"),
		    #"Duplicated Column3" = Table.DuplicateColumn(#"Duplicated Column2", "consignee_state", "consignee_state - Copy"),
		    #"Merged Columns" = Table.CombineColumns(#"Duplicated Column3",{"shipper_city_name - Copy", "shipper_state - Copy"},Combiner.CombineTextByDelimiter(", ", QuoteStyle.None),"Shipper"),
		    #"Merged Columns1" = Table.CombineColumns(#"Merged Columns",{"consignee_city_name - Copy", "consignee_state - Copy"},Combiner.CombineTextByDelimiter(", ", QuoteStyle.None),"Consignee"),
		    //End Add Lane
		    #"Merged Columns2" = Table.CombineColumns(#"Merged Columns1",{"Shipper", "Consignee"},Combiner.CombineTextByDelimiter(" - ", QuoteStyle.None),"lane"),
		    #"Trimmed Text1" = Table.TransformColumns(#"Merged Columns2",{{"shipper_stop_id", Text.Trim, type text}})
		in
		    #"Trimmed Text1"
	lineageTag: ecc7d6f2-89e7-440c-8625-c2621e2e918e
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression RefreshCutOffDate = #datetime(2025, 7, 1, 0, 0, 0) meta [IsParameterQuery=true, Type="DateTime", IsParameterQueryRequired=true]
	lineageTag: af39c097-cda3-4307-8194-af7487559d9a
	queryGroup: Parameters

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = DateTime

expression MovementCutOffNumber = 192267 meta [IsParameterQuery=true, Type="Number", IsParameterQueryRequired=true]
	lineageTag: 7b1d95af-7d84-440e-87b8-e089fa08fe15
	queryGroup: Parameters

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Number

expression mcleod_historic_movement =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_movement = Source{[Schema="dbo",Item="movement"]}[Data],
		    #"Changed Type" = Table.TransformColumnTypes(dbo_movement,{{"id", type number}}),
		    #"filtered movements pre MovmentCuttOFfNumber" = Table.SelectRows(#"Changed Type", each [id] < MovementCutOffNumber),
		    #"Changed Type1" = Table.TransformColumnTypes(#"filtered movements pre MovmentCuttOFfNumber",{{"id", type text}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Changed Type1",{"company_id", "authorized", "average_broker_rating", "booking_no", "br_details_link", "br_status_link", "br_track_interval", "br_track_status", "br_tracking_id", "br_vendor", "broker_avail_tract", "brokerage", "carrier_contact", "carrier_email", "carrier_fuel_pay_rate_id", "carrier_lane_rate_id", "carrier_override_user", "carrier_phone", "carrier_rate_id", "chassis", "checkcall_sched_id", "container", "container_returned", "container_status", "controlling_carrier_code", "dedicated_order_id", "est_tolls", "est_tolls_c", "est_tolls_d", "est_tolls_n", "est_tolls_r", "exclude_movement", "fleet_manager", "freight_matching_override", "fuel_distance_um", "fuel_tax_exempt", "hubtran_approved_inv_date", "hubtran_ok2pay_date", "integrated_carrier_search", "is_container", "is_dray", "is_local_mile", "linked_id", "linked_sequence", "loaded", "locked_user_id", "ltl", "ltl_staging_wrs_uid", "macropoint_status", "manifest_empty_distance", "manifest_estimated_arrival", "manifest_estimated_depart", "manifest_id", "manifest_loaded_distance", "manifest_reg_uid", "manifest_spots_capacity", "manifest_spots_consumed", "manifest_weight_capacity", "manifest_weight_consumed", "max_buy_c", "max_buy_d", "max_buy_n", "max_buy_r", "max_pay_method", "max_pay_units", "missed_call_sent", "fuel_distance", "move_distance_um", "movement_type", "must_respond_by", "next_sched_call", "operational_status", "operations_user", "override_crny_type", "override_driver_id", "override_driver_nm", "override_drvr_cell", "override_drvr_email", "override_max_pay", "override_max_pay_c", "override_max_pay_d", "override_max_pay_n", "override_max_pay_r", "override_pay_amt_c", "override_pay_amt_d", "override_pay_amt_n", "override_pay_amt_r", "override_paye_rate", "override_targetpay_c", "override_targetpay_d", "override_targetpay_n", "override_targetpay_r", "override_unit_desc", "override_units", "pay_distance", "pay_distance_um", "placard_required", "priority", "pro_nbr", "rate_alert_basis", "rate_alert_date", "rate_alert_days", "rate_alert_hours", "rate_alert_minutes", "rate_confirm_template", "rate_confirmation_sent_date", "rate_confirmation_status", "rate_expiration_basis", "rate_expiration_date", "rate_expiration_days", "rate_expiration_hours", "rate_expiration_minutes", "rdy_pickup_date", "recurring_movement_id", "reminder_sent", "required_vendor", "reserved", "return_date", "seg_alloc_code", "ss_location_id", "target_extra_stop_pay", "target_extra_stop_pay_c", "target_extra_stop_pay_d", "target_extra_stop_pay_n", "target_extra_stop_pay_r", "target_fuel_surcharge_pay", "target_pay_c", "target_pay_d", "target_pay_n", "target_pay_r", "target_pay_method", "target_pay_units", "target_rate_id", "time_to_send_msg", "tracking_request_status", "trailer_rent_pct", "trip_lease", "trip_mgt_recalc_datetime", "trip_mgt_tracking_id", "triumphpay_exclude", "trp_uid", "unlock_time", "waterfall_flood_time", "waterfall_in_progress", "xferred2fueltax", "xferred2fueltaxdt", "xmit_accepted", "xmitted2driver", "zmit_trip", "require_tracking", "ts_borrowing_company", "ts_commodity", "ts_movement_id", "tracking_duration_ext", "tracking_notify_email", "shpmt_ident_type", "shpmt_ident_value", "override_driver2_nm", "ic_company_to", "load_booking_source", "override_drvr2_email", "track_start_date", "br_track_vehicle_id", "br_track_status_desc", "pending_carrier_type", "shipper_email", "carrier_override_carrier", "pending_carrier_name", "override_driver2_id", "carrier_empty_from_city_id", "shipper_notify_frequency", "pending_carrier_nbr", "ic_order_to", "digital_booking", "is_intercompany", "override_drvr2_cell", "carrier_tractor", "carrier_trailer", "equipment_group_id", "empty2next_order", "eform_rate_confirmation", "override_pay_rate", "preassign_sequence", "carrier_trailer_type", "pending_payee_id"}),
		    #"Filtered Rows" = Table.SelectRows(#"Removed Columns", each ([status] <> "V")),
		    //start replacing teams with parade
		    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows","team17","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","team16","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","team15","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","team14","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value4" = Table.ReplaceValue(#"Replaced Value3","team13","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value5" = Table.ReplaceValue(#"Replaced Value4","team12","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value6" = Table.ReplaceValue(#"Replaced Value5","team10","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value7" = Table.ReplaceValue(#"Replaced Value6","team9","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value8" = Table.ReplaceValue(#"Replaced Value7","team8","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value9" = Table.ReplaceValue(#"Replaced Value8","team7","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value10" = Table.ReplaceValue(#"Replaced Value9","team6","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value11" = Table.ReplaceValue(#"Replaced Value10","team5","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value12" = Table.ReplaceValue(#"Replaced Value11","team4","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value13" = Table.ReplaceValue(#"Replaced Value12","team3","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value14" = Table.ReplaceValue(#"Replaced Value13","team2","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value15" = Table.ReplaceValue(#"Replaced Value14","team1","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Replaced Value16" = Table.ReplaceValue(#"Replaced Value15","cdispatch","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    //end replace teams with parade
		    #"Replaced Value17" = Table.ReplaceValue(#"Replaced Value16","cbt","parade",Replacer.ReplaceText,{"dispatcher_user_id"}),
		    #"Trimmed Text" = Table.TransformColumns(#"Replaced Value17",{{"dispatcher_user_id", Text.Trim, type text}}),
		    #"Uppercased Text" = Table.TransformColumns(#"Trimmed Text",{{"dispatcher_user_id", Text.Upper, type text}})
		in
		    #"Uppercased Text"
	lineageTag: 913af15e-8ef1-470b-a516-92c5e6d44a04
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression mcleod_historic_driver_extra_pay =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_driver_extra_pay = Source{[Schema="dbo",Item="driver_extra_pay"]}[Data],
		    #"Filtered Pay pre RefreshCutOffDate" = Table.SelectRows(dbo_driver_extra_pay, each [amount_d] < RefreshCutOffDate),
		    #"Removed Columns" = Table.RemoveColumns(#"Filtered Pay pre RefreshCutOffDate",{"company_id", "amount_c", "amount_d", "amount_n", "amount_r", "carrier_rate_id", "descr", "detention_hist_pay_id", "driver_id", "fuel_surcharge_pay", "jag_rate_id", "order_id", "rate", "reference_no", "rev_uid", "transaction_date", "units"})
		in
		    #"Removed Columns"
	lineageTag: c2f81b9b-4fbb-45cc-baa7-0086b2f2998d
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression mcleod_historic_movement_order =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_movement_order = Source{[Schema="dbo",Item="movement_order"]}[Data],
		    #"Changed Type" = Table.TransformColumnTypes(dbo_movement_order,{{"movement_id", type number}}),
		    #"Filtered Pre MovementCutOffNumber" = Table.SelectRows(#"Changed Type", each [movement_id] < MovementCutOffNumber),
		    #"Removed Columns" = Table.RemoveColumns(#"Filtered Pre MovementCutOffNumber",{"company_id", "id", "on_at_move_dest", "on_at_move_origin", "planned_manifest_id"})
		in
		    #"Removed Columns"
	lineageTag: 98afc80b-1ced-4813-84ff-49fa95dcea19
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression movement_order =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_movement_order = Source{[Schema="dbo",Item="movement_order"]}[Data],
		    #"Changed Type" = Table.TransformColumnTypes(dbo_movement_order,{{"movement_id", type number}}),
		    #"Filtered >= MovementCutOffNumber" = Table.SelectRows(#"Changed Type", each [movement_id] >= MovementCutOffNumber),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Filtered >= MovementCutOffNumber",{{"movement_id", type text}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Changed Type1",{"company_id", "id", "on_at_move_dest", "on_at_move_origin", "planned_manifest_id"}),
		    #"Appended Query" = Table.Combine({#"Removed Columns", mcleod_historic_movement_order}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Appended Query",{{"movement_id", type text}}),
		    #"Trimmed Text" = Table.TransformColumns(#"Changed Type2",{{"movement_id", Text.Trim, type text}})
		in
		    #"Trimmed Text"
	lineageTag: 32c1816d-fe91-435a-8362-5ffc4dd06ca1
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression Parameter1 = #"Sample File" meta [IsParameterQuery=true, BinaryIdentifier=#"Sample File", Type="Binary", IsParameterQueryRequired=true]
	lineageTag: 59e49c03-a356-4cef-87fc-37914b4d1cd5
	queryGroup: 'Transform File from historic_parade_orders\Helper Queries'

	annotation PBI_ResultType = Binary

expression 'Transform Sample File' =
		let
		    Source = Excel.Workbook(Parameter1, null, true),
		    Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])
		in
		    #"Promoted Headers"
	lineageTag: 1fbdd36a-69da-4bdd-8d07-bdf16a9c249c
	queryGroup: 'Transform File from historic_parade_orders'

	annotation PBI_ResultType = Table

expression 'Sample File' =
		let
		    Source = SharePoint.Files("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam", [ApiVersion = 15]),
		    #"Reordered Columns" = Table.ReorderColumns(Source,{"Content", "Name", "Extension", "Date accessed", "Date modified", "Date created", "Folder Path", "Attributes"}),
		    #"Filtered Rows" = Table.SelectRows(#"Reordered Columns", each Text.Contains([Folder Path], "02 BL-Areas/bridge_iq/Data Sets/Parade/parade_orders_api_files")),
		    Navigation1 = #"Filtered Rows"{0}[Content]
		in
		    Navigation1
	lineageTag: 3619b482-2bf8-4f12-915b-aab38357cf1f
	queryGroup: 'Transform File from historic_parade_orders\Helper Queries'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Binary

expression 'Transform File' =
		let
		    Source = (Parameter1 as binary) => let
		        Source = Excel.Workbook(Parameter1, null, true),
		        Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		        #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])
		    in
		        #"Promoted Headers"
		in
		    Source
	lineageTag: 9bb2a554-9b20-411a-b1b6-ea04113e9d7c
	queryGroup: 'Transform File from historic_parade_orders\Helper Queries'

	annotation PBI_ResultType = Function

expression Parameter2 = #"Sample File (2)" meta [IsParameterQuery=true, BinaryIdentifier=#"Sample File (2)", Type="Binary", IsParameterQueryRequired=true]
	lineageTag: f0b8ebc3-304f-43e6-bbee-db250c156091
	queryGroup: 'Transform File from parade_orders\Helper Queries'

	annotation PBI_ResultType = Binary

expression 'Transform Sample File (2)' =
		let
		    Source = Excel.Workbook(Parameter2, null, true),
		    Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])
		in
		    #"Promoted Headers"
	lineageTag: b142244a-63e0-49ba-9f70-76864dbaf607
	queryGroup: 'Transform File from parade_orders'

	annotation PBI_ResultType = Table

expression 'Sample File (2)' =
		let
		    Source = SharePoint.Files("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam", [ApiVersion = 15]),
		    #"Reordered Columns" = Table.ReorderColumns(Source,{"Content", "Name", "Extension", "Date accessed", "Date modified", "Date created", "Folder Path", "Attributes"}),
		    #"Filtered Rows" = Table.SelectRows(#"Reordered Columns", each Text.Contains([Folder Path], "02 BL-Areas/bridge_iq/Data Sets/Parade/parade_orders_api_files")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows", each [Attributes]?[Hidden]? <> true),
		    Navigation1 = #"Filtered Hidden Files1"{0}[Content]
		in
		    Navigation1
	lineageTag: c286de1c-fe54-4fb7-9c49-86bf12c129db
	queryGroup: 'Transform File from parade_orders\Helper Queries'

	annotation PBI_ResultType = Binary

expression 'Transform File (2)' =
		let
		    Source = (Parameter2 as binary) => let
		        Source = Excel.Workbook(Parameter2, null, true),
		        Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		        #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])
		    in
		        #"Promoted Headers"
		in
		    Source
	lineageTag: bf0440a7-90f6-460f-9fbc-c2f0a8fce758
	queryGroup: 'Transform File from parade_orders\Helper Queries'

	annotation PBI_ResultType = Function

expression historic_parade_orders =
		let
		    Source = SharePoint.Files("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam", [ApiVersion = 15]),
		    #"Reordered Columns" = Table.ReorderColumns(Source,{"Content", "Name", "Extension", "Date accessed", "Date modified", "Date created", "Folder Path", "Attributes"}),
		    #"Filtered Rows" = Table.SelectRows(#"Reordered Columns", each Text.Contains([Folder Path], "02 BL-Areas/bridge_iq/Data Sets/Parade/parade_orders_api_files")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows", each [Attributes]?[Hidden]? <> true),
		    #"Invoke Custom Function1" = Table.AddColumn(#"Filtered Hidden Files1", "Transform File", each #"Transform File"([Content])),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Invoke Custom Function1", {"Transform File"}),
		    #"Expanded Table Column1" = Table.ExpandTableColumn(#"Removed Other Columns1", "Transform File", Table.ColumnNames(#"Transform File"(#"Sample File"))),
		    #"Changed Type" = Table.TransformColumnTypes(#"Expanded Table Column1",{{"id", Int64.Type}, {"reference_id", type text}, {"created_at", type datetime}, {"archived_at", type datetime}, {"src_city", type text}, {"src_state", type text}, {"src_date", type date}, {"src_postal_code", type text}, {"dst_city", type text}, {"dst_state", type text}, {"dst_date", type date}, {"dst_postal_code", type text}, {"num_stops", Int64.Type}, {"equipment", type text}, {"trailer_type", type text}, {"rate_customer", type number}, {"first_load", type logical}, {"customer_id", type text}, {"revenue_code", Int64.Type}, {"team_name", type any}, {"rep_email", type text}, {"rep_name", type text}, {"carrier_manager", type text}, {"category", type text}, {"conversion_category", type text}, {"partner", type text}, {"margin_amount", type number}, {"margin_pct", type number}, {"carrier_name", type text}, {"dot_number", Int64.Type}, {"mc_number", Int64.Type}, {"carrier_rate", type number}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"rate_customer", Currency.Type}, {"margin_amount", Currency.Type}}),
		    #"Sorted Rows" = Table.Sort(#"Changed Type1",{{"reference_id", Order.Ascending}}),
		    #"Extracted Text After Delimiter" = Table.TransformColumns(#"Sorted Rows", {{"reference_id", each Text.AfterDelimiter(_, "-"), type text}}),
		    #"Removed Blank Rows" = Table.SelectRows(#"Extracted Text After Delimiter", each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Blank Rows",{{"reference_id", "movement_id"}}),
		    #"Filtered Rows1" = Table.SelectRows(#"Renamed Columns", each ([category] <> "outside_parade") and ([conversion_category] <> "Manually Assigned")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows1", {"id"}),
		    #"Filtered orders before RefreshCutOffDate" = Table.SelectRows(#"Removed Duplicates", each [created_at] < RefreshCutOffDate),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered orders before RefreshCutOffDate", each [conversion_category] <> null and [conversion_category] <> "")
		in
		    #"Filtered Rows2"
	lineageTag: 95446394-12c9-44d4-bfbc-ea7f8fb2d92d
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression historic_callins =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_callin = Source{[Schema="dbo",Item="callin"]}[Data],
		    #"Removed Other Columns" = Table.SelectColumns(dbo_callin,{"entered_by", "entered_date", "movement_status", "payee_id", "initiated_type", "movement_id"}),
		    #"Filtered callins before RefreshCutOffDate" = Table.SelectRows(#"Removed Other Columns", each [entered_date] < RefreshCutOffDate),
		    #"Inserted Time" = Table.AddColumn(#"Filtered callins before RefreshCutOffDate", "Time", each DateTime.Time([entered_date]), type time),
		    #"Renamed Columns" = Table.RenameColumns(#"Inserted Time",{{"Time", "entered_time"}, {"entered_date", "entered_date_time"}}),
		    #"Inserted Date" = Table.AddColumn(#"Renamed Columns", "Date", each DateTime.Date([entered_date_time]), type date),
		    #"Calculated Start of Hour" = Table.TransformColumns(#"Inserted Date",{{"entered_time", Time.StartOfHour, type time}})
		in
		    #"Calculated Start of Hour"
	lineageTag: 56bd229e-e47a-4149-814e-6b72b080d909
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression dnc =
		let
		    Source = Excel.Workbook(Web.Contents("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam/Shared%20Documents/02%20BL-Areas/bridge_iq/Data%20Sets/DNC/DNC.xlsx"), null, true),
		    dnc_Table = Source{[Item="dnc",Kind="Table"]}[Data],
		    #"Changed Type" = Table.TransformColumnTypes(dnc_Table,{{"DNC", type text}}),
		    #"Removed Duplicates" = Table.Distinct(#"Changed Type")
		in
		    #"Removed Duplicates"
	lineageTag: 404f9e09-a9e5-41cf-8435-ee73acb35e66

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression Parameter3 = #"Sample File (3)" meta [IsParameterQuery=true, BinaryIdentifier=#"Sample File (3)", Type="Binary", IsParameterQueryRequired=true]
	lineageTag: c5b8bf0c-fa84-413d-a472-27c7814f3c56
	queryGroup: 'Transform File from behaviors\Helper Queries'

	annotation PBI_ResultType = Binary

expression 'Transform Sample File (3)' =
		let
		    Source = Excel.Workbook(Parameter3, null, true),
		    Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])
		in
		    #"Promoted Headers"
	lineageTag: 04305715-2431-48aa-84c3-4fffc150748a
	queryGroup: 'Transform File from behaviors'

	annotation PBI_ResultType = Table

expression 'Sample File (3)' =
		let
		    Source = SharePoint.Files("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each Text.Contains([Folder Path], "https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam/Shared Documents/02 BL-Areas/bridge_iq/Data Sets/behaviors_api_files/")),
		    Navigation1 = #"Filtered Rows"{0}[Content]
		in
		    Navigation1
	lineageTag: fc6fe0e2-27aa-48a4-8d3b-f19ba57636e6
	queryGroup: 'Transform File from behaviors\Helper Queries'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Binary

expression 'Transform File (3)' =
		let
		    Source = (Parameter3 as binary) => let
		        Source = Excel.Workbook(Parameter3, null, true),
		        Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		        #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])
		    in
		        #"Promoted Headers"
		in
		    Source
	lineageTag: b594b25c-1827-4acd-ae47-d19aae6df491
	queryGroup: 'Transform File from behaviors\Helper Queries'

	annotation PBI_ResultType = Function

expression Parameter4 = #"Sample File (4)" meta [IsParameterQuery=true, BinaryIdentifier=#"Sample File (4)", Type="Binary", IsParameterQueryRequired=true]
	lineageTag: 50f5d478-8d0f-4752-923f-22e5b5b84184
	queryGroup: 'Transform File from historic_behaviors\Helper Queries'

	annotation PBI_ResultType = Binary

expression 'Transform Sample File (4)' =
		let
		    Source = Excel.Workbook(Parameter4, null, true),
		    Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])
		in
		    #"Promoted Headers"
	lineageTag: 40157f7e-dcc8-4409-9d8f-b835b60dc51f
	queryGroup: 'Transform File from historic_behaviors'

	annotation PBI_ResultType = Table

expression 'Sample File (4)' =
		let
		    Source = SharePoint.Files("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each Text.Contains([Folder Path], "https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam/Shared Documents/02 BL-Areas/bridge_iq/Data Sets/behaviors_api_files/")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows", each [Attributes]?[Hidden]? <> true),
		    Navigation1 = #"Filtered Hidden Files1"{0}[Content]
		in
		    Navigation1
	lineageTag: 6c753d56-0e08-4fa7-8bde-cdf69a56d0ac
	queryGroup: 'Transform File from historic_behaviors\Helper Queries'

	annotation PBI_ResultType = Binary

expression 'Transform File (4)' =
		let
		    Source = (Parameter4 as binary) => let
		        Source = Excel.Workbook(Parameter4, null, true),
		        Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		        #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])
		    in
		        #"Promoted Headers"
		in
		    Source
	lineageTag: 96187a1f-dd5c-48bf-9faa-843e6b5cd850
	queryGroup: 'Transform File from historic_behaviors\Helper Queries'

	annotation PBI_ResultType = Function

expression historic_behaviors =
		let
		    Source = SharePoint.Files("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam", [ApiVersion = 15]),
		    #"Filtered Rows" = Table.SelectRows(Source, each Text.Contains([Folder Path], "https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam/Shared Documents/02 BL-Areas/bridge_iq/Data Sets/behaviors_api_files/")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows", each [Attributes]?[Hidden]? <> true),
		    #"Filtered Hidden Files2" = Table.SelectRows(#"Filtered Hidden Files1", each [Attributes]?[Hidden]? <> true),
		    #"Invoke Custom Function1" = Table.AddColumn(#"Filtered Hidden Files2", "Transform File (4)", each #"Transform File (4)"([Content])),
		    #"Renamed Columns1" = Table.RenameColumns(#"Invoke Custom Function1", {"Name", "Source.Name"}),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Renamed Columns1", {"Source.Name", "Transform File (4)"}),
		    #"Expanded Table Column1" = Table.ExpandTableColumn(#"Removed Other Columns1", "Transform File (4)", Table.ColumnNames(#"Transform File (4)"(#"Sample File (4)"))),
		    #"Changed Type" = Table.TransformColumnTypes(#"Expanded Table Column1",{{"Source.Name", type text}, {"id", Int64.Type}, {"date", type datetime}, {"author_id", type any}, {"mail_activity_type_id", type text}, {"model", type text}, {"res_id", Int64.Type}}),
		    #"Filtered Rows1" = Table.SelectRows(#"Changed Type", each true),
		    #"Removed Columns" = Table.RemoveColumns(#"Filtered Rows1",{"Source.Name"}),
		    #"Extracted Text Between Delimiters" = Table.TransformColumns(#"Removed Columns", {{"author_id", each Text.BetweenDelimiters(_, "'", "'"), type text}, {"mail_activity_type_id", each Text.BetweenDelimiters(_, "'", "'"), type text}}),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Extracted Text Between Delimiters", {{"author_id", null}}),
		    #"Filtered Rows2" = Table.SelectRows(#"Replaced Errors", each ([model] <> "gamification.badge.user") and ([author_id] <> null and [author_id] <> "OdooBot" and [author_id] <> "Portal User Template")),
		    #"Inserted Time" = Table.AddColumn(#"Filtered Rows2", "Time", each DateTime.Time([date]), type time),
		    #"Renamed Columns2" = Table.RenameColumns(#"Inserted Time",{{"date", "Behavior Date"}, {"Time", "Behavior Time"}}),
		    #"Filtered Rows3" = Table.SelectRows(#"Renamed Columns2", each [Behavior Date] < RefreshCutOffDate),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Filtered Rows3",{{"Behavior Date", type date}}),
		    #"Inserted Start of Month" = Table.AddColumn(#"Changed Type1", "Start of Month", each Date.StartOfMonth([Behavior Date]), type date),
		    #"Calculated Start of Hour" = Table.TransformColumns(#"Inserted Start of Month",{{"Behavior Time", Time.StartOfHour, type time}})
		in
		    #"Calculated Start of Hour"
	lineageTag: 797f4845-cadf-4720-8f56-c0abeae60b99
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression users =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_users = Source{[Schema="dbo",Item="users"]}[Data],
		    #"Filtered Rows" = Table.SelectRows(dbo_users, each ([web_user_type] = "U")),
		    #"Removed Other Columns" = Table.SelectColumns(#"Filtered Rows",{"revenue_code_id", "id"}),
		    #"Uppercased Text" = Table.TransformColumns(#"Removed Other Columns",{{"id", Text.Upper, type text}}),
		    #"Trimmed Text" = Table.TransformColumns(#"Uppercased Text",{{"id", Text.Trim, type text}}),
		    #"Cleaned Text" = Table.TransformColumns(#"Trimmed Text",{{"id", Text.Clean, type text}})
		in
		    #"Cleaned Text"
	lineageTag: b0d9ea90-2639-4ad1-97d0-43f2699756a9

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression parade_orders =
		let
		    Source = SharePoint.Files("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam", [ApiVersion = 15]),
		    #"Reordered Columns" = Table.ReorderColumns(Source,{"Content", "Name", "Extension", "Date accessed", "Date modified", "Date created", "Folder Path", "Attributes"}),
		    #"Filtered Rows" = Table.SelectRows(#"Reordered Columns", each Text.Contains([Folder Path], "02 BL-Areas/bridge_iq/Data Sets/Parade/parade_orders_api_files")),
		    #"Filtered Hidden Files1" = Table.SelectRows(#"Filtered Rows", each [Attributes]?[Hidden]? <> true),
		    #"Filtered Hidden Files2" = Table.SelectRows(#"Filtered Hidden Files1", each [Attributes]?[Hidden]? <> true),
		    #"Invoke Custom Function1" = Table.AddColumn(#"Filtered Hidden Files2", "Transform File (2)", each #"Transform File (2)"([Content])),
		    #"Removed Other Columns1" = Table.SelectColumns(#"Invoke Custom Function1", {"Transform File (2)"}),
		    #"Expanded Table Column1" = Table.ExpandTableColumn(#"Removed Other Columns1", "Transform File (2)", Table.ColumnNames(#"Transform File (2)"(#"Sample File (2)"))),
		    #"Changed Type" = Table.TransformColumnTypes(#"Expanded Table Column1",{{"id", Int64.Type}, {"reference_id", type text}, {"created_at", type datetime}, {"archived_at", type datetime}, {"src_city", type text}, {"src_state", type text}, {"src_date", type date}, {"src_postal_code", type text}, {"dst_city", type text}, {"dst_state", type text}, {"dst_date", type date}, {"dst_postal_code", type text}, {"num_stops", Int64.Type}, {"equipment", type text}, {"trailer_type", type text}, {"rate_customer", type number}, {"first_load", type logical}, {"customer_id", type text}, {"revenue_code", Int64.Type}, {"team_name", type any}, {"rep_email", type text}, {"rep_name", type text}, {"carrier_manager", type text}, {"category", type text}, {"conversion_category", type text}, {"partner", type text}, {"margin_amount", type number}, {"margin_pct", type number}, {"carrier_name", type text}, {"dot_number", Int64.Type}, {"mc_number", Int64.Type}, {"carrier_rate", type number}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type",{{"rate_customer", Currency.Type}, {"margin_amount", Currency.Type}}),
		    #"Sorted Rows" = Table.Sort(#"Changed Type1",{{"reference_id", Order.Ascending}}),
		    #"Extracted Text After Delimiter" = Table.TransformColumns(#"Sorted Rows", {{"reference_id", each Text.AfterDelimiter(_, "-"), type text}}),
		    #"Removed Blank Rows" = Table.SelectRows(#"Extracted Text After Delimiter", each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))),
		    #"Renamed Columns" = Table.RenameColumns(#"Removed Blank Rows",{{"reference_id", "movement_id"}}),
		    #"Filtered Rows1" = Table.SelectRows(#"Renamed Columns", each ([category] <> "outside_parade" and [category] <> "unsuccessful_quote")),
		    #"Filtered Rows2" = Table.SelectRows(#"Filtered Rows1", each ([category] <> "digital_visit")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows2", {"id"}),
		    #"Filtered Rows3" = Table.SelectRows(#"Removed Duplicates", each [conversion_category] <> null and [conversion_category] <> ""),
		    #"Filtered Orders on or after RefreshCutOffDate" = Table.SelectRows(#"Filtered Rows3", each [created_at] >= RefreshCutOffDate),
		    #"Appended Query" = Table.Combine({#"Filtered Orders on or after RefreshCutOffDate", historic_parade_orders})
		in
		    #"Appended Query"
	lineageTag: 61f23af1-ed35-407d-a264-f6699d7ceacf

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression Contacts =
		let
		    Source = Excel.Workbook(Web.Contents("https://bridgelogisticsinc.sharepoint.com/sites/BL-BiTeam/Shared%20Documents/02%20BL-Areas/bridge_iq/Data%20Sets/CRM/new_contacts.xlsx"), null, true),
		    Sheet1_Sheet = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
		    #"Promoted Headers" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true]),
		    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"id", Int64.Type}, {"is_company", type logical}, {"x_studio_mcleod_code", type any}, {"parent_id", type any}, {"name", type text}, {"city", type any}, {"phone", type any}, {"x_studio_zoominfo_contact_id", type any}, {"user_id", type any}, {"x_studio_sdr", type logical}, {"x_studio_last_stage_update", type any}, {"x_studio_zoominfo_company_id", type any}, {"activity_date_deadline", type any}, {"x_studio_lead_type", type any}, {"x_studio_originally_passed_to", type logical}, {"x_studio_do_not_move", type logical}, {"x_studio_lead_passed_date", type any}, {"x_studio_enrichment_date", type any}, {"x_studio_revenue_range", type any}, {"x_studio_last_salesperson_update", type datetime}, {"x_studio_primary_industry", type any}, {"state_id", type any}, {"x_res_partner_prospecting_stage", type any}, {"x_studio_last_activity_date", type any}, {"x_studio_working_start_date", type any}, {"x_studio_working_end_date", type any}, {"x_studio_no_for_now_start_date", type any}, {"x_studio_no_for_now_end_date", type logical}, {"x_studio_hope_island_start_date", type logical}, {"x_studio_hope_island_end_date", type logical}, {"x_studio_qualified_start_date", type logical}, {"x_studio_qualified_end_date", type logical}, {"x_studio_quoted_start_date", type logical}, {"x_studio_quoted_end_date", type logical}, {"x_studio_credit_app_start_date", type logical}, {"x_studio_credit_app_end_date", type any}, {"x_studio_1_3_loads_start_date", type logical}, {"x_studio_1_3_loads_end_date", type logical}, {"x_studio_customer_start_date", type any}, {"x_studio_customer_end_date", type logical}, {"category_names", type text}, {"user_login", type text}}),
		    #"Extracted Text Between Delimiters" = Table.TransformColumns(#"Changed Type", {{"user_id", each Text.BetweenDelimiters(Text.From(_, "en-US"), "'", "'"), type text}}),
		    #"Extracted Text Between Delimiters1" = Table.TransformColumns(#"Extracted Text Between Delimiters", {{"x_studio_sdr", each Text.BetweenDelimiters(Text.From(_, "en-US"), "'", "'"), type text}}),
		    #"Extracted Text Between Delimiters2" = Table.TransformColumns(#"Extracted Text Between Delimiters1", {{"x_studio_originally_passed_to", each Text.BetweenDelimiters(Text.From(_, "en-US"), "'", "'"), type text}}),
		    #"Extracted Text Between Delimiters3" = Table.TransformColumns(#"Extracted Text Between Delimiters2", {{"x_studio_revenue_range", each Text.BetweenDelimiters(Text.From(_, "en-US"), "'", "'"), type text}}),
		    #"Extracted Text Between Delimiters4" = Table.TransformColumns(#"Extracted Text Between Delimiters3", {{"x_studio_primary_industry", each Text.BetweenDelimiters(Text.From(_, "en-US"), "'", "'"), type text}}),
		    #"Extracted Text Between Delimiters5" = Table.TransformColumns(#"Extracted Text Between Delimiters4", {{"state_id", each Text.BetweenDelimiters(_, "'", "'"), type text}}),
		    #"Extracted Text Between Delimiters6" = Table.TransformColumns(#"Extracted Text Between Delimiters5", {{"x_res_partner_prospecting_stage", each Text.BetweenDelimiters(_, "'", "'"), type text}}),
		    #"Extracted Text Between Delimiters7" = Table.TransformColumns(#"Extracted Text Between Delimiters6", {{"parent_id", each Text.BetweenDelimiters(Text.From(_, "en-US"), "'", "'"), type text}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Extracted Text Between Delimiters7",{{"x_studio_last_stage_update", type datetime}, {"activity_date_deadline", type datetime}, {"x_studio_last_salesperson_update", type datetime}, {"x_studio_last_activity_date", type datetime}, {"x_studio_working_start_date", type datetime}, {"x_studio_working_end_date", type datetime}, {"x_studio_no_for_now_start_date", type datetime}, {"x_studio_no_for_now_end_date", type datetime}, {"x_studio_hope_island_start_date", type datetime}, {"x_studio_hope_island_end_date", type datetime}, {"x_studio_qualified_start_date", type datetime}, {"x_studio_qualified_end_date", type datetime}, {"x_studio_quoted_start_date", type datetime}, {"x_studio_quoted_end_date", type datetime}, {"x_studio_credit_app_start_date", type datetime}, {"x_studio_credit_app_end_date", type datetime}, {"x_studio_1_3_loads_start_date", type datetime}, {"x_studio_1_3_loads_end_date", type datetime}, {"x_studio_customer_start_date", type datetime}, {"x_studio_customer_end_date", type datetime}}),
		    #"Replaced Errors" = Table.ReplaceErrorValues(#"Changed Type1", {{"x_studio_last_stage_update", null},{"activity_date_deadline", null},{"x_studio_last_activity_date", null},{"x_studio_working_start_date", null},{"x_studio_working_end_date", null},{"x_studio_no_for_now_start_date", null},{"x_studio_no_for_now_end_date", null},{"x_studio_hope_island_start_date", null},{"x_studio_hope_island_end_date", null},{"x_studio_qualified_start_date", null},{"x_studio_qualified_end_date", null},{"x_studio_quoted_start_date", null},{"x_studio_quoted_end_date", null},{"x_studio_credit_app_start_date", null},{"x_studio_credit_app_end_date", null},{"x_studio_1_3_loads_start_date", null},{"x_studio_1_3_loads_end_date", null},{"x_studio_customer_start_date", null},{"x_studio_customer_end_date", null}}),
		    #"Replaced Value" = Table.ReplaceValue(#"Replaced Errors",false,null,Replacer.ReplaceValue,{"x_studio_mcleod_code"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","",null,Replacer.ReplaceValue,{"parent_id"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1",false,null,Replacer.ReplaceValue,{"city"}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2",false,null,Replacer.ReplaceValue,{"phone"}),
		    #"Replaced Value4" = Table.ReplaceValue(#"Replaced Value3",false,null,Replacer.ReplaceValue,{"x_studio_zoominfo_contact_id"}),
		    #"Replaced Value5" = Table.ReplaceValue(#"Replaced Value4","",null,Replacer.ReplaceValue,{"user_id"}),
		    #"Replaced Errors1" = Table.ReplaceErrorValues(#"Replaced Value5", {{"x_studio_sdr", null}}),
		    #"Replaced Value6" = Table.ReplaceValue(#"Replaced Errors1","",null,Replacer.ReplaceValue,{"x_studio_sdr"}),
		    #"Replaced Value7" = Table.ReplaceValue(#"Replaced Value6",false,null,Replacer.ReplaceValue,{"x_studio_lead_type"}),
		    #"Replaced Errors2" = Table.ReplaceErrorValues(#"Replaced Value7", {{"x_studio_originally_passed_to", null}}),
		    #"Replaced Value8" = Table.ReplaceValue(#"Replaced Errors2","",null,Replacer.ReplaceValue,{"x_studio_originally_passed_to"}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Replaced Value8",{{"x_studio_enrichment_date", type date}}),
		    #"Replaced Errors3" = Table.ReplaceErrorValues(#"Changed Type2", {{"x_studio_enrichment_date", null}}),
		    #"Replaced Value9" = Table.ReplaceValue(#"Replaced Errors3","",null,Replacer.ReplaceValue,{"x_studio_revenue_range"}),
		    #"Replaced Value10" = Table.ReplaceValue(#"Replaced Value9","",null,Replacer.ReplaceValue,{"x_studio_primary_industry"}),
		    #"Replaced Errors4" = Table.ReplaceErrorValues(#"Replaced Value10", {{"state_id", null}}),
		    #"Replaced Errors5" = Table.ReplaceErrorValues(#"Replaced Errors4", {{"x_res_partner_prospecting_stage", null}}),
		    #"Replaced Errors6" = Table.ReplaceErrorValues(#"Replaced Errors5", {{"x_studio_last_salesperson_update", null}})
		in
		    #"Replaced Errors6"
	lineageTag: a86aa7ea-8ec8-4b2b-9536-14c46f5da6d7
	queryGroup: 'Historic Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression off_payee =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_off_payee = Source{[Schema="dbo",Item="off_payee"]}[Data],
		    #"Filtered Rows" = Table.SelectRows(dbo_off_payee, each ([office_paymethod] = "S")),
		    #"Removed Other Columns" = Table.SelectColumns(#"Filtered Rows",{"regular_rate", "id"})
		in
		    #"Removed Other Columns"
	lineageTag: 490c4ab9-bc43-499e-a0a2-034ce13df49e

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Errors in ffl week schedule' =
		let
		Source = #"ffl week schedule",
		  #"Detected Type Mismatches" = let
		    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Source, Table.ColumnsOfType(Source, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),
		    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),
		    fieldNames = Record.FieldNames(recordTypeFields),
		    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),
		    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = "The type of the value does not match the type of the column.", Detail = v], fieldTypes{i}})
		in
		    Table.TransformColumns(Source, pairs),
		  #"Added Index" = Table.AddIndexColumn(#"Detected Type Mismatches", "Row Number" ,1),
		  #"Kept Errors" = Table.SelectRowsWithErrors(#"Added Index", {"id", "Weeks ", "start of week", "end of week ", " team 1A", "team 1B", " team 2A", "team 2B"}),
		  #"Reordered Columns" = Table.ReorderColumns(#"Kept Errors", {"Row Number", "id", "Weeks ", "start of week", "end of week ", " team 1A", "team 1B", " team 2A", "team 2B"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Reordered Columns",{{" team 1A", type text}, {"team 1B", type text}, {" team 2A", type text}, {"team 2B", type text}})
		in
		  #"Changed Type"
	lineageTag: 4ae8eb2c-d515-4b92-b8a5-4eb32fb00f3e
	queryGroup: 'Query Errors - 10/16/2025 9:01:05 AM'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression drs_payee =
		let
		    Source = Sql.Database("bl-appdb", "lme"),
		    dbo_drs_payee = Source{[Schema="dbo",Item="drs_payee"]}[Data],
		    #"Removed Other Columns" = Table.SelectColumns(dbo_drs_payee,{"dot_number", "factoring_company_id", "icc_number", "id"})
		in
		    #"Removed Other Columns"
	lineageTag: 878c148a-1e31-4d67-8b16-ab3f6f7dc4de

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

